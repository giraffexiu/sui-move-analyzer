# 需求文档

## 介绍

本功能实现了一个针对 Sui Move 项目的函数分析器。该分析器允许用户导入 Sui Move 项目，指定函数名称，并获取该函数的全面信息，包括源代码、参数、位置信息以及与其他函数的调用关系。此工具旨在帮助开发者理解 Move 智能合约中的代码结构和依赖关系。

## 需求

### 需求 1

**用户故事：** 作为开发者，我希望通过提供目录路径来导入 Sui Move 项目，以便分析该项目中的函数。

#### 验收标准

1. 当用户提供有效的 Sui Move 项目目录路径时，系统应验证项目结构
2. 当项目包含有效的 Move.toml 文件时，系统应解析项目配置
3. 当项目结构有效时，系统应索引项目中的所有 Move 源文件
4. 如果项目结构无效，系统应返回指示问题的错误消息

### 需求 2

**用户故事：** 作为开发者，我希望指定要分析的函数名称，以便获取该特定函数的详细信息。

#### 验收标准

1. 当用户提供函数名称时，系统应在所有已索引的 Move 文件中搜索该函数
2. 当找到函数时，系统应提取完整的函数定义
3. 当存在多个同名函数时，系统应返回所有匹配函数的信息
4. 如果未找到函数，系统应返回指示未找到函数的错误消息

### 需求 3

**用户故事：** 作为开发者，我希望获取函数的源代码和位置信息，以便理解函数的实现并在代码库中定位它。

#### 验收标准

1. 当分析函数时，系统应返回函数的完整源代码
2. 当提取源代码时，系统应包含文件路径、起始行号和结束行号
3. 当函数有文档注释时，系统应将其包含在源代码中
4. 当函数跨越多行时，系统应保持原始格式和缩进

### 需求 4

**用户故事：** 作为开发者，我希望获取函数参数的信息，以便理解函数的接口和预期输入。

#### 验收标准

1. 当函数有参数时，系统应提取每个参数的名称和类型
2. 当参数具有复杂类型时，系统应表示完整的类型签名
3. 当函数没有参数时，系统应返回空的参数数组
4. 当参数具有泛型类型时，系统应包含泛型类型信息

### 需求 5

**用户故事：** 作为开发者，我希望识别被分析函数调用的所有函数，以便理解函数的依赖关系和调用图。

#### 验收标准

1. 当函数调用其他函数时，系统应识别函数体内的所有函数调用
2. 当识别函数调用时，系统应包含被调用函数的名称、模块和文件位置
3. 当函数调用外部模块函数时，系统应识别模块和函数名称
4. 当函数没有函数调用时，系统应返回空的调用数组
5. 当函数调用内置 Move 函数时，系统应将其与用户定义函数区分开来

### 需求 6

**用户故事：** 作为开发者，我希望分析结果采用结构化的 JSON 格式，以便轻松地将工具与其他开发工作流程和工具集成。

#### 验收标准

1. 当分析完成时，系统应以 JSON 格式返回结果
2. 当格式化结果时，系统应包含合约/模块名称、函数签名、源代码、位置、参数和调用信息
3. 当多个函数匹配时，系统应返回函数分析结果数组
4. 当发生错误时，系统应以 JSON 格式返回结构化错误信息

### 需求 7

**用户故事：** 作为开发者，我希望工具能处理 Move 特定的语法和功能，以便对 Move 智能合约的分析准确无误。

#### 验收标准

1. 当解析 Move 代码时，系统应正确处理 Move 特定的关键字和语法
2. 当分析函数调用时，系统应识别 Move 的方法调用语法（点符号）
3. 当处理类型时，系统应处理 Move 的资源类型、引用和泛型类型
4. 当分析模块时，系统应理解 Move 的模块系统和导入